% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hmm_distribution.R
\name{hmm}
\alias{hmm}
\title{Define a Hidden Markov Model}
\usage{
hmm(initial, transition, emission, n_timesteps)
}
\arguments{
\item{initial}{a length K row vector (ie. 1 x K matrix) of probabilities of
initial hidden states}

\item{transition}{a K x K matrix of transition probabilities between hidden
states}

\item{emission}{a K x N matrix of emission probabilities between hidden and
observed states}

\item{n_timesteps}{the number of timesteps (length of the observed state
matrix) - must be a positive scalar integer}
}
\description{
\code{hmm()} create a variable greta array following a Hidden Markov
Model (HMM) 'distribution'. That is a probability distribution whose
density is given by the probability of observing a sequence of observed
states (the variable greta array), given a transition and an emission
matrix as its parameters. This can be viewed as a compound distribution
consisting of a categorical distribution over observed states, conditional
on hidden states which (sequentially) follow another categorical
distribution of states. The log density is calculated by analytically
integrating out the hidden states using the forward algorithm.

This is a discrete, multivariate distribution, and is most likely to be
used with \code{\link{distribution}()} to define a complete HMM, as in the
example.

The transition and emission matrices should represent simplices; having
rows summing to 1. These can be create with e.g.
\code{\link[greta:imultilogit]{imultilogit}()}.
}
\examples{
\dontrun{

# simulate data
n_hidden <- 2
n_observable <- 2
timesteps <- 20
initial <- random_simplex_matrix(1, n_hidden)
transition <- random_simplex_matrix(n_hidden,
                                    n_hidden)
emission <- random_simplex_matrix(n_hidden,
                                  n_observable)
hmm_data <- simulate_hmm(initial,
                         transition,
                         emission,
                         timesteps)
obs <- hmm_data$observed

# create simplex variables for the parameters
initial <- dirichlet(ones(1, n_hidden))
transition <- dirichlet(ones(n_hidden, n_hidden))
emission <- dirichlet(ones(n_hidden, n_observable))

# define the HMM over the observed states
distribution(obs) <- hmm(initial, transition, emission, timesteps)

# build the model
m <- model(transition, emission, initial)

}
}
